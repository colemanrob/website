<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Codes | </title>
    <link>/code/</link>
      <atom:link href="/code/index.xml" rel="self" type="application/rss+xml" />
    <description>Codes</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>Â© 2017 - 2020 Rob Coleman</copyright><lastBuildDate>Sun, 28 Jun 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/images/icon_hudbb411c2d94366f168d6aa78f52f5e7d_25002_512x512_fill_lanczos_center_2.png</url>
      <title>Codes</title>
      <link>/code/</link>
    </image>
    
    <item>
      <title>Making Tables</title>
      <link>/code/making-tables/</link>
      <pubDate>Sun, 28 Jun 2020 00:00:00 +0000</pubDate>
      <guid>/code/making-tables/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve wanted to dive into the 
&lt;a href=&#34;https://gt.rstudio.com/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gt&lt;/a&gt; package for making tables for awhile now.  Here is a quick example of a table using data from a tidy tuesday a few weeks back.  It seems my hugo theme is over-writing some of the table css, I&amp;rsquo;ll have to check that out.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(tidyverse)

library(gt)
&lt;/code&gt;&lt;/pre&gt;
&lt;style type=&#34;text/css&#34;&gt;
table&gt;tbody&gt;tr:nth-child(odd)&gt;td, table&gt;tbody&gt;tr:nth-child(odd)&gt;th {
    background-color: #fff;
}
table &gt; tbody &gt; tr:hover &gt; td,
table &gt; tbody &gt; tr:hover &gt; th {
  background-color: #fff;
}
.article-style img, .article-style video {
  height: auto;
  margin-left: auto;
  margin-right: auto;
  margin-top: 0;
  margin-bottom: 0;
  padding: 0;
}
&lt;/style&gt;
&lt;p&gt;Let&amp;rsquo;s read in the cocktails recipie&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;boston_cocktails &amp;lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-26/boston_cocktails.csv&#39;) %&amp;gt;% 
  janitor::clean_names()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&amp;rsquo;s make the data reasonable!&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;boston_tidy &amp;lt;- boston_cocktails %&amp;gt;% 
  # fix the measurements
  separate(measure, into = c(&#39;value&#39;, &#39;measurement&#39;), sep = &amp;quot; &amp;quot;, remove = FALSE) %&amp;gt;% 
  # remove values that don&#39;t have properly formed measurements crudely
  filter(measurement == &amp;quot;oz&amp;quot;) %&amp;gt;% 
  # convert fractions to decimals
  mutate(value = case_when(
    value == &amp;quot;1/2&amp;quot; ~ &amp;quot;.5&amp;quot;,
    value == &amp;quot;1/3&amp;quot; ~ &amp;quot;.33&amp;quot;,
    value == &amp;quot;1/4&amp;quot; ~ &amp;quot;.25&amp;quot;,
    value == &amp;quot;3/4&amp;quot; ~ &amp;quot;.74&amp;quot;,
    TRUE ~ value
  )) %&amp;gt;% 
  # magic
  type_convert() %&amp;gt;% 
  # only keep realistic values
  filter(value &amp;lt;= 5)

boston_table &amp;lt;- boston_tidy%&amp;gt;% 
  filter(!category %in% c(&#39;Non-alcoholic Drinks&#39;, &#39;Rum&#39;, &#39;Shooters&#39;)) %&amp;gt;% 
  group_by(category, name) %&amp;gt;% 
  summarize(total_ingredients = which.max(ingredient_number),
            total_ounces = sum(value)) %&amp;gt;% 
  arrange(category, desc(total_ingredients)) %&amp;gt;% 
  slice_head(n = 5, order_by = total_ingredients) %&amp;gt;% 
  arrange(category) %&amp;gt;% 
  ungroup()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;make the table&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;boston_gt_table &amp;lt;- gt(boston_table, 
                      rowname_col = &amp;quot;name&amp;quot;,
                      groupname_col = &amp;quot;category&amp;quot;)


boston_gt_table &amp;lt;- boston_gt_table %&amp;gt;% 
  tab_header(
    title = &amp;quot;Top cocktails by Category&amp;quot;,
    subtitle = &amp;quot;Top 5 cocktails based on number of ingredients&amp;quot;
  ) %&amp;gt;% 
  tab_spanner(label = &amp;quot;Drink Information&amp;quot;,
              columns = vars(&amp;quot;total_ingredients&amp;quot;, &amp;quot;total_ounces&amp;quot;)) %&amp;gt;% 
  cols_label(
    total_ingredients = &amp;quot;Total Ingredients&amp;quot;,
    total_ounces = &amp;quot;Total Ounces&amp;quot;,
    name = &amp;quot;Name&amp;quot;
  ) %&amp;gt;% 
  summary_rows(
    groups = TRUE,
    columns = vars(total_ingredients, total_ounces),
    fns = list(Total = &amp;quot;sum&amp;quot;),
    formatter = fmt_number,
    decimals = 2,
    use_seps = TRUE
  ) 

boston_gt_table %&amp;gt;% 
  tab_source_note(
    source_note = md(&amp;quot;Data comes from the [Tidy Tuesday project](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-05-26/readme.md)&amp;quot;)
  ) %&amp;gt;% 
  opt_align_table_header(align = &amp;quot;center&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;!--html_preserve--&gt;&lt;style&gt;html {
&lt;p&gt;font-family: -apple-system, BlinkMacSystemFont, &amp;lsquo;Segoe UI&amp;rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &amp;lsquo;Helvetica Neue&amp;rsquo;, &amp;lsquo;Fira Sans&amp;rsquo;, &amp;lsquo;Droid Sans&amp;rsquo;, Arial, sans-serif;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_table {
display: table;
border-collapse: collapse;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 0;
padding-bottom: 4px;
border-top-color: #FFFFFF;
border-top-width: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_column_spanner_outer:first-child {
padding-left: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_column_spanner_outer:last-child {
padding-right: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_group_heading {
padding: 8px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_from_md &amp;gt; :first-child {
margin-top: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_from_md &amp;gt; :last-child {
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 12px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_first_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_footnote {
margin: 0px;
font-size: 90%;
padding: 4px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_sourcenote {
font-size: 90%;
padding: 4px;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_left {
text-align: left;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_center {
text-align: center;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_font_normal {
font-weight: normal;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_font_bold {
font-weight: bold;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_font_italic {
font-style: italic;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_super {
font-size: 65%;
}&lt;/p&gt;
&lt;p&gt;#jrihnhzhfn .gt_footnote_marks {
font-style: italic;
font-size: 65%;
}
&lt;/style&gt;&lt;/p&gt;
&lt;div id=&#34;jrihnhzhfn&#34; style=&#34;overflow-x:auto;overflow-y:auto;width:auto;height:auto;&#34;&gt;&lt;table class=&#34;gt_table&#34;&gt;
  &lt;thead class=&#34;gt_header&#34;&gt;
    &lt;tr&gt;
      &lt;th colspan=&#34;3&#34; class=&#34;gt_heading gt_title gt_font_normal&#34; style&gt;Top cocktails by Category&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th colspan=&#34;3&#34; class=&#34;gt_heading gt_subtitle gt_font_normal gt_bottom_border&#34; style&gt;Top 5 cocktails based on number of ingredients&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;thead class=&#34;gt_col_headings&#34;&gt;
    &lt;tr&gt;
      &lt;th class=&#34;gt_col_heading gt_columns_bottom_border gt_left&#34; rowspan=&#34;2&#34; colspan=&#34;1&#34;&gt;&lt;/th&gt;
      &lt;th class=&#34;gt_center gt_columns_top_border gt_column_spanner_outer&#34; rowspan=&#34;1&#34; colspan=&#34;2&#34;&gt;
        &lt;span class=&#34;gt_column_spanner&#34;&gt;Drink Information&lt;/span&gt;
      &lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th class=&#34;gt_col_heading gt_columns_bottom_border gt_center&#34; rowspan=&#34;1&#34; colspan=&#34;1&#34;&gt;Total Ingredients&lt;/th&gt;
      &lt;th class=&#34;gt_col_heading gt_columns_bottom_border gt_center&#34; rowspan=&#34;1&#34; colspan=&#34;1&#34;&gt;Total Ounces&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class=&#34;gt_table_body&#34;&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Brandy&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Champs Elysees Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Cherry Blossom&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;2.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;D&#39;artagnan&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;6.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Deauville Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;3.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Gilroy Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;3.48&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;25.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;19.48&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Cocktail Classics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Eye-Opener&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;6.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Gloom Lifter&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Hyatt&#39;s Jamaican Banana&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;New Orleans Gin Fizz&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;6.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Prairie Oyster Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;6.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;30.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;28.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Cordials and Liqueurs&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Praire Oyster Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Absinthe Special Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;2&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;1.25&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Amaretto Rose&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;2&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;1.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Amaretto Sour&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;2&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;1.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Amber Amour&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;2&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;0.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;13.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;8.99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Gin&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;The Winkle&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;11.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Vow Of Silence&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;2.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;The Wink&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;4&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Water Lily&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;4&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;2.96&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Western Rose&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;4&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;3.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;23.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;23.70&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Rum - Daiquiris&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Hai Karate&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;7.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Ko Adang&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Zombie&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;7.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Floridita No. 3&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Hush and Wonder&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;5&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;7.48&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;28.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;30.72&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Tequila&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Amante Picante&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;10.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Chupa Cabra&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Flower Power&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;9.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Oldest Temptation&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.25&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;The Nomad South&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;30.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;35.49&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Vodka&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Ibiza&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Long Island Iced Tea&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Purple Passion Iced Tea&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;3.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Sonic Blaster&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;4.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Thyme Collins&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;10.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;30.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;27.44&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr class=&#34;gt_group_heading_row&#34;&gt;
      &lt;td colspan=&#34;3&#34; class=&#34;gt_group_heading&#34;&gt;Whiskies&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Blarney Stone Cocktail&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;California Lemonade&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;6.25&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Carre Reprise&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Chi-Town Flip&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;5.47&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_left gt_stub&#34;&gt;Double Standard Sour&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;6&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;3.73&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_stub gt_right gt_summary_row gt_first_summary_row&#34;&gt;Total&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_center gt_summary_row gt_first_summary_row&#34;&gt;30.00&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right gt_summary_row gt_first_summary_row&#34;&gt;26.45&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot class=&#34;gt_sourcenotes&#34;&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_sourcenote&#34; colspan=&#34;3&#34;&gt;Data comes from the &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-05-26/readme.md&#34;&gt;Tidy Tuesday project&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;&lt;/div&gt;&lt;!--/html_preserve--&gt;
&lt;p&gt;More to come!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tidyverse tricks</title>
      <link>/code/dplyr-tricks/</link>
      <pubDate>Sun, 07 Jun 2020 00:00:00 +0000</pubDate>
      <guid>/code/dplyr-tricks/</guid>
      <description>&lt;p&gt;The following is a list of functions that are super useful in the tidyverse that help solve a wide range of problems:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;#add_count&#34;&gt;add_count&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;#crossing&#34;&gt;crossing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Get data from tidytues

library(tidyverse)
cocktails &amp;lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-26/cocktails.csv&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;add_count&#34;&gt;&lt;code&gt;add_count&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;adds a count based on the variable supplied.  Equivalent to group_by, summarize, ungroup.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cocktails %&amp;gt;% 
  add_count(drink) %&amp;gt;% 
  filter(n &amp;gt;= 12) %&amp;gt;% 
  knitr::kable()
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;right&#34;&gt;row_id&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;drink&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;date_modified&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;id_drink&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;alcoholic&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;category&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;drink_thumb&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;glass&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;iba&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;video&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;ingredient_number&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ingredient&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;measure&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica root&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3 tblsp chopped&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Water&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1/4 cup&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Food coloring&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 drop yellow&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Food coloring&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 drop green&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Almond&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 tblsp chopped&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Allspice&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 cracked&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Cinnamon&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 one-inch&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Anise&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3-6 crushed&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Coriander&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1/8 tsp powdered&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Marjoram leaves&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1 tblsp fresh chopped&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Vodka&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1.5 cup&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;88&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Angelica Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-31 19:21:12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12794&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Alcoholic&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Homemade Liqueur&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;a href=&#34;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&#34;&gt;http://www.thecocktaildb.com/images/media/drink/yuurps1472667672.jpg&lt;/a&gt;&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Collins Glass&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Sugar&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1/2 cup granulated&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;crossing&#34;&gt;&lt;code&gt;crossing&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;generates all possible combinations of variables (like expand.grid, but returns a dataframe)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;crossing(
  a = 1:2,
  b = c(&amp;quot;a&amp;quot;, &amp;quot;b&amp;quot;),
  c = c(&amp;quot;x&amp;quot;, &amp;quot;y&amp;quot;)
) %&amp;gt;% 
  knitr::kable()
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;right&#34;&gt;a&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;b&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;c&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;a&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;a&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;b&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;b&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;a&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;a&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;b&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;b&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;y&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>Type Convert</title>
      <link>/code/type-convert/</link>
      <pubDate>Sun, 31 May 2020 00:00:00 +0000</pubDate>
      <guid>/code/type-convert/</guid>
      <description>&lt;p&gt;Never noticed &lt;code&gt;type_convert&lt;/code&gt; from &lt;code&gt;readr&lt;/code&gt; that lets you wrangle data and then convert as appropriate.  Let&amp;rsquo;s give it a spin.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(tidyverse)

typical_data &amp;lt;- tribble(~bad_col,
                        &amp;quot;3_apple&amp;quot;,
                        &amp;quot;4_banana&amp;quot;)

typical_data %&amp;gt;% 
  separate(bad_col, into = c(&amp;quot;n&amp;quot;, &amp;quot;fruit&amp;quot;), sep = &amp;quot;_&amp;quot;) %&amp;gt;% 
  type_convert()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 2
##       n fruit 
##   &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt; 
## 1     3 apple 
## 2     4 banana
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Perfect!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Notes on fuzzy matching</title>
      <link>/code/notes-on-fuzzy-matching/</link>
      <pubDate>Sat, 05 Oct 2019 00:00:00 +0000</pubDate>
      <guid>/code/notes-on-fuzzy-matching/</guid>
      <description>&lt;p&gt;Recently had the pleasure of fuzzy matching two datasets that included first and last name and date of birth.  Here are some notes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://github.com/dgrtwo/fuzzyjoin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;fuzzyjoin package&lt;/a&gt; - great functions that do most of the heavy lifting&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;http://finzi.psych.upenn.edu/library/stringdist/html/stringdist-metrics.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;string metrics&lt;/a&gt; - there are a lot of ways to measure the difference in strings, selecting a metric depends on the problem&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;toy-example&#34;&gt;Toy Example&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(tidyverse)
library(fuzzyjoin)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create our list of names and dobs.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;inside_list &amp;lt;- tribble(
  ~first, ~last, ~dob,
  &amp;quot;frank&amp;quot;, &amp;quot;johnson&amp;quot;, &amp;quot;1980-01-01&amp;quot;,
  &amp;quot;debbie&amp;quot;, &amp;quot;willis&amp;quot;, &amp;quot;1982-01-01&amp;quot;
) %&amp;gt;% mutate(dob = parse_date(dob, format = &amp;quot;%Y-%m-%d&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a second list to be matched against&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;outside_list &amp;lt;- tribble(
  ~first, ~last, ~dob,
  &amp;quot;frank&amp;quot;, &amp;quot;johnson&amp;quot;, &amp;quot;1980-01-01&amp;quot;,
  &amp;quot;debrah&amp;quot;, &amp;quot;willis&amp;quot;, &amp;quot;1982-01-02&amp;quot;
) %&amp;gt;% mutate(dob = parse_date(dob, format = &amp;quot;%Y-%m-%d&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Use the function of your choice.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;stringdist_join(outside_list, inside_list,
                by = c(&amp;quot;first&amp;quot;, &amp;quot;last&amp;quot;, &amp;quot;dob&amp;quot;),
                ignore_case = TRUE,
                distance_col = &amp;quot;dist&amp;quot;,
                mode = &amp;quot;left&amp;quot;,
                method = &amp;quot;lv&amp;quot;,
                max_dist = 20) %&amp;gt;% 
  mutate(total_distance = dob.dist + first.dist + last.dist) %&amp;gt;% 
  select(-ends_with(&amp;quot;.dist&amp;quot;)) %&amp;gt;% 
  knitr::kable()
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;first.x&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;last.x&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;dob.x&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;first.y&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;last.y&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;dob.y&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;dist&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total_distance&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;frank&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;johnson&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1980-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;frank&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;johnson&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1980-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;frank&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;johnson&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1980-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;debbie&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;willis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1982-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;debrah&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;willis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1982-01-02&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;frank&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;johnson&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1980-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;debrah&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;willis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1982-01-02&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;debbie&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;willis&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1982-01-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;You can see the difference between &lt;em&gt;debrah&lt;/em&gt; and &lt;em&gt;debbie&lt;/em&gt; is 4.&lt;/p&gt;
&lt;p&gt;Setting the distance threshold is often a function of how exact you want the matches to be.&lt;/p&gt;
&lt;p&gt;See the 
&lt;a href=&#34;http://varianceexplained.org/fuzzyjoin/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;fuzzyjoin&lt;/a&gt; reference for more.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Analyzing Commuting Patterns in Ontario</title>
      <link>/code/analyzing-commuting-patterns-in-ontario/</link>
      <pubDate>Sun, 03 Mar 2019 00:00:00 +0000</pubDate>
      <guid>/code/analyzing-commuting-patterns-in-ontario/</guid>
      <description>&lt;p&gt;I was inspired by 
&lt;a href=&#34;http://varianceexplained.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;David Robinson&lt;/a&gt;&amp;lsquo;s latest webcast in which he made a heatmap of French train delays using &lt;code&gt;geom_tile&lt;/code&gt; and wanted to try it out for myself.&lt;/p&gt;
&lt;center&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;In this week&amp;#39;s &lt;a href=&#34;https://twitter.com/hashtag/tidytuesday?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#tidytuesday&lt;/a&gt; screencast, I analyze delays in French train stations ð«ð·ð&lt;br&gt;&lt;br&gt;I show how to create heatmaps of delays (inspired by &lt;a href=&#34;https://twitter.com/noccaea?ref_src=twsrc%5Etfw&#34;&gt;@noccaea&lt;/a&gt;!), and embarrass myself with even the simplest French pronunciations&lt;a href=&#34;https://t.co/zBrkIkdcCz&#34;&gt;https://t.co/zBrkIkdcCz&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://t.co/RI7ZpxV89X&#34;&gt;pic.twitter.com/RI7ZpxV89X&lt;/a&gt;&lt;/p&gt;&amp;mdash; David Robinson (@drob) &lt;a href=&#34;https://twitter.com/drob/status/1100456189752688640?ref_src=twsrc%5Etfw&#34;&gt;February 26, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;/center&gt;
&lt;p&gt;I don&amp;rsquo;t have a lot of opportunities to use heatmaps, but recently Statcan has released their 
&lt;a href=&#34;https://www12.statcan.gc.ca/census-recensement/2016/rt-td/jtw-ddt-eng.cfm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Journey to Work&lt;/a&gt; data as part of the 2016 Census.  I wanted to see if I could use a heatmap to understand the commuting patterns in communities in southern Ontario.&lt;/p&gt;
&lt;h3 id=&#34;load-packages&#34;&gt;Load packages&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(tidyverse)
library(cancensus)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I downloaded the 
&lt;a href=&#34;https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/dt-td/Rp-eng.cfm?LANG=E&amp;amp;APATH=3&amp;amp;DETAIL=0&amp;amp;DIM=0&amp;amp;FL=A&amp;amp;FREE=0&amp;amp;GC=0&amp;amp;GID=0&amp;amp;GK=0&amp;amp;GRP=1&amp;amp;PID=113344&amp;amp;PRID=10&amp;amp;PTYPE=109445&amp;amp;S=0&amp;amp;SHOWALL=0&amp;amp;SUB=0&amp;amp;Temporal=2017&amp;amp;THEME=125&amp;amp;VID=0&amp;amp;VNAMEE=&amp;amp;VNAMEF=&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;commuting table&lt;/a&gt; from statscan because I couldn&amp;rsquo;t find it using the &lt;code&gt;cancensus&lt;/code&gt; package.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;raw_commute &amp;lt;- read_csv(&amp;quot;~/projects/R stuff/commute/98-400-X2016391_English_CSV_data.csv&amp;quot;) %&amp;gt;% 
    janitor::clean_names() %&amp;gt;% 
    select(code = geo_code_por,
           live = geo_name,
           work = geo_name_1,
           total = dim_sex_3_member_id_1_total_sex)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# filter only those whose code starts w/ 35 (Ontario)
ontario_commute &amp;lt;- raw_commute %&amp;gt;% 
    filter(str_detect(code, pattern = &amp;quot;^35&amp;quot;)) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;download-geography-data&#34;&gt;Download geography data&lt;/h3&gt;
&lt;p&gt;I was able to retrieve the working age population and census division geographies using &lt;code&gt;cancensus&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(cancensus)
library(sf)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Linking to GEOS 3.7.0, GDAL 2.3.2, PROJ 5.2.0
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# create list of ontario census divisions to pass to cancensus
regions_list_ontario &amp;lt;- list_census_regions(&amp;quot;CA16&amp;quot;) %&amp;gt;% 
  filter(str_detect(region, pattern = &amp;quot;^35&amp;quot;))  %&amp;gt;% 
  as_census_region_list
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Querying CensusMapper API for regions data...
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;pop_data &amp;lt;- get_census(&amp;quot;CA16&amp;quot;,
                           regions = regions_list_ontario,
                           vectors = &amp;quot;v_CA16_61&amp;quot;,
                           level = &amp;quot;CD&amp;quot;,
                       geo_format = &amp;quot;sf&amp;quot;, labels = &amp;quot;short&amp;quot;) %&amp;gt;% 
  janitor::clean_names()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# clean
pop_data %&amp;gt;% 
  mutate(working_age = v_ca16_61) %&amp;gt;% 
  mutate(code = as.double(geo_uid)) %&amp;gt;% 
  select(code, working_age, shape_area, geometry) -&amp;gt; pop_data_clean
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;joining-the-tables-together&#34;&gt;Joining the tables together&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# remove commuting within cd, compute totals
ontario_commute %&amp;gt;% 
  filter(live != work) %&amp;gt;%
  group_by(live) %&amp;gt;% 
  mutate(total_commuters = sum(total),
         prop_commuters = total / total_commuters ) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  left_join(pop_data_clean, by = &amp;quot;code&amp;quot;) %&amp;gt;% 
  group_by(work) %&amp;gt;% 
  mutate(total_commuters_destination = sum(total)) %&amp;gt;% 
  mutate(live_prop = total_commuters / working_age,
         work_prop = total / working_age ) %&amp;gt;% 
  ungroup() -&amp;gt; ontario_commute_clean
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;create-visualizations&#34;&gt;Create visualizations&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s see what visualizations will work.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ontario_commute_clean %&amp;gt;% 
    filter(total &amp;gt;= 3000) %&amp;gt;% 
    mutate(live = str_wrap(live, width = 15)) %&amp;gt;% 
    mutate(live = fct_reorder(live, total)) %&amp;gt;% 
    mutate(work = fct_reorder(work, total)) %&amp;gt;% 
    ggplot(aes(live, work, fill = total)) +
    geom_tile(alpha = 0.7) +
    theme_light() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
    scale_fill_viridis_c(labels = scales::comma_format()) +
    labs(fill = &amp;quot;# of commuters&amp;quot;,
         title = &amp;quot;The largest number of commuters in Ontario are those who live in York, Peel and Durham who commute to Toronto for work&amp;quot;,
         subtitle = &amp;quot;Number of employed labour force aged 15+ who commute by Census Division - Minimum 3,000 commuters to be represented&amp;quot;,
         x = &amp;quot;Live - Census Division&amp;quot;,
         y = &amp;quot;Work - Census Division&amp;quot;,
         caption = &amp;quot;Data from Statistics Canada 2016 Canadian Census - Journey to Work \n https://www12.statcan.gc.ca/census-recensement/2016/rt-td/jtw-ddt-eng.cfm&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/img/commute.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;map-the-proportions&#34;&gt;Map the proportions&lt;/h3&gt;
&lt;p&gt;I&amp;rsquo;m always trying to improve my mapping skills and &lt;code&gt;geom_sf&lt;/code&gt; makes it a lot easier.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ontario_commute_clean %&amp;gt;% 
  filter((!live %in% c(&amp;quot;Rainy River&amp;quot;, &amp;quot;Kenora&amp;quot;, &amp;quot;Thunder Bay&amp;quot;, &amp;quot;Algoma&amp;quot;, &amp;quot;Nipissing&amp;quot;, 
                       &amp;quot;Cochrane&amp;quot;, &amp;quot;Greater Sudbury / Grand Sudbury&amp;quot;, &amp;quot;Manitoulin&amp;quot;,
                       &amp;quot;Timiskaming&amp;quot;, &amp;quot;Sudbury&amp;quot;, &amp;quot;Parry Sound&amp;quot;))) %&amp;gt;% 
  ggplot() +
  geom_sf(aes(fill = live_prop)) +
  scale_fill_viridis_c(&amp;quot;% Labour force who commute to work&amp;quot;, labels = scales::percent) + theme_minimal() +
  theme(panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) + 
  coord_sf(datum=NA) +
  labs(title = &amp;quot;The % of the labour force (aged 15+) who commute by Census Division in Southern Ontario&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/img/map.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Scraping Restaurant Inspection Reports</title>
      <link>/code/scraping-restaurant-inspection-reports/</link>
      <pubDate>Tue, 05 Dec 2017 00:00:00 +0000</pubDate>
      <guid>/code/scraping-restaurant-inspection-reports/</guid>
      <description>&lt;p&gt;
&lt;a href=&#34;http://www.algomapublichealth.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Algoma Public Health&lt;/a&gt; is the public health agency in my area that inspects restaurants to ensure they are abiding by all the relevant food safety legislation. They are also nice enough to publish their 
&lt;a href=&#34;http://www.algomapublichealth.com/inspections-environment/food-safety/restaurant-inspection-reports/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;restaurant health inspection reports&lt;/a&gt; online for anyone to review.&lt;/p&gt;
&lt;p&gt;I searched for a few restaurants that I frequent (phew 
&lt;a href=&#34;https://goo.gl/maps/rqj5goqwqeT2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fratellis&lt;/a&gt; is safe!) but then I wanted to know &lt;strong&gt;which restaurants had the most health infractions?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Their website isn&amp;rsquo;t setup to answer that kind of question. Each inspection report is published as a unique page on their website which makes aggregating and comparing difficult.&lt;/p&gt;
&lt;p&gt;I used &lt;code&gt;rvest&lt;/code&gt; to scrape the URLs of all the reports APH published. Then I scraped the contents of the reports so that I could create a dataset that would allow me to aggregate and compare the results (the dataset and code 
&lt;a href=&#34;https://github.com/colemanrob/restoscrape/tree/master/data&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;available here&lt;/a&gt;.)&lt;/p&gt;
&lt;h2 id=&#34;restaurants-with-the-most-infractions&#34;&gt;Restaurants with the most infractions&lt;/h2&gt;
&lt;p&gt;Of the 90% of restaurants who received three visits, here are the top 5 in terms of total number of infractions:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/img/resto1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Surprising results. Upper Deck has some 
&lt;a href=&#34;http://www.algomapublichealth.com/inspections-environment/food-safety/restaurant-inspection-reports/?id=7e880c25-6cd5-4e01-bcf4-7ad707ae166f&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;particularly bad&lt;/a&gt; health infractions.&lt;/p&gt;
&lt;p&gt;But that got me thinking&amp;ndash;not all infractions are equal. Some are minor and are corrected onsite. Some are more serious and others still are downright strange. Let&amp;rsquo;s take a closer look.&lt;/p&gt;
&lt;h2 id=&#34;number-of-infractions&#34;&gt;Number of infractions&lt;/h2&gt;
&lt;p&gt;Here are the top 10 infractions by frequency, meaning these infractions appear most often in the dataset.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/img/resto2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;stranger-infractions&#34;&gt;Stranger Infractions&lt;/h2&gt;
&lt;p&gt;The infractions that don&amp;rsquo;t appear frequently are also quite interesting. Here are infractions that only appear once in the dataset, but leave me with more questions than answers.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Restaurant&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Address&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Date&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Infraction&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Juicy Beatz &amp;amp; Healthy Eatz&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;235 McNabb Street&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2017-08-23&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Food handler hygiene&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Pauline&amp;rsquo;s Place&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;923 Queen Street&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2017-11-28&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Only Grade A or B eggs permitted&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Queen West Variety&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;602 Queen Street&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-12-16&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Exclusion of live animals on the premises, subject to exemptions&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Roberta Bondar Pavilion Serving Kitchens&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;65 Foster Dr&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-08-30&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;No room with food used for sleeping purposes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;Teen Challenge Kitchen&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1446 Great Northern Road&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2016-12-13&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Uninspected meats obtained through hunting: only for custom cutting, wash/rinse/sanitize equipment after use as prescribed&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Questions that come to mind:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;who&amp;rsquo;s sleeping in the Pavilion?&lt;/li&gt;
&lt;li&gt;did the Teen Challenge involve catching your meal?&lt;/li&gt;
&lt;li&gt;what kind of animals are hanging out in Queen West Variety?&lt;/li&gt;
&lt;li&gt;how does one tell the grade of eggs? Can you do it just by looking?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What does this data tell us? Not too much really :)&lt;/p&gt;
&lt;p&gt;I hope you enjoyed this peek behind the health inspection curtain. The dataset and code are 
&lt;a href=&#34;https://github.com/colemanrob/restoscrape/tree/master/data&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;available here&lt;/a&gt;. If you have any questions or comments, please feel free to 
&lt;a href=&#34;https://twitter.com/coleman&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;get in touch&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
